{"version":3,"sources":["menu.js"],"names":[],"mappings":"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","file":"menu.js","sourcesContent":["import { keys, onKey } from './keys'\nimport inspecting from './lib/inspecting'\n\nconst Tools = _DT\nconst toEditor = Tools.messageEditor\n\nview Menu {\n  let active = false\n  let top, left\n  let elements = []\n\n  // prevent select and show custom cursor when ready for context\n  let focused\n  on.keydown(() => {\n    if (keys.alt && keys.command) {\n      document.body.classList.add('__flintfocus')\n      focused = true\n    }\n  })\n  on.keyup(() => {\n    if (focused) {\n      document.body.classList.remove('__flintfocus')\n      focused = false\n    }\n  })\n\n  on.click(window, e => {\n    if (active) {\n      e.stopPropagation()\n      e.preventDefault()\n      active = false\n      return\n    }\n\n    const mode = keys.alt && keys.command\n    if (!mode) return\n\n    e.preventDefault()\n\n    const { clientX, clientY } = e\n\n    left = clientX\n    top = clientY\n    active = true\n    elements = inspecting.all()\n  })\n\n  function focusElement(el) {\n    return function() {\n      toEditor({ type: 'focus:element', key: el.key, view: el.view })\n    }\n  }\n\n  function focusStyle(el) {\n    return function() {\n      toEditor({ type: 'focus:style', el: el.el, view: el.view })\n    }\n  }\n\n; <menu class={{ internal: true, active }}>\n    <item\n      repeat={elements.filter(i => !!i.view)}\n      class={{\n        first: _index == 0,\n        last: _index == elements.length - 1\n      }}\n    >\n      <main class=\"hl\" onClick={focusElement(_)}>{_.view}</main>\n      <sub class=\"hl\" onClick={focusStyle(_)}>$</sub>\n    </item>\n  </menu>\n\n  const rad = 5\n\n  $menu = {\n    borderRadius: rad,\n    border: '1px solid #ddd',\n    boxShadow: '0 0 10px rgba(0,0,0,0.2)',\n    position: 'absolute',\n    top,\n    left,\n    background: '#fff',\n    zIndex: 2147483647,\n    transition: 'opacity ease-in 30ms, transform ease-in 30ms',\n    opacity: 0,\n    transform: { y: -10 },\n    pointerEvents: 'none',\n    padding: 0\n  }\n\n  $active = {\n    pointerEvents: 'auto',\n    opacity: 1,\n    transform: { y: 0 }\n  }\n\n  $item = {\n    minWidth: 120,\n    cursor: 'pointer',\n    flexFlow: 'row',\n  }\n\n  $first = {\n    borderTopLeftRadius: rad,\n    borderTopRightRadius: rad,\n    overflow: 'hidden'\n  }\n\n  $last = {\n    borderBottomLeftRadius: rad,\n    borderBottomRightRadius: rad,\n    overflow: 'hidden'\n  }\n\n  $hl = {\n    padding: [4, 8],\n\n    hover: {\n      background: [0,0,0,0.1]\n    }\n  }\n\n  $main = {\n    flexGrow: 1\n  }\n}\n"],"sourceRoot":"/source/"}